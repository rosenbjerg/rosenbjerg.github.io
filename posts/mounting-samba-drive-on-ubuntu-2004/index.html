<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Mounting samba share on Ubuntu 20.04 | Rosenbjerg blog</title><meta name=keywords content="linux,nas,samba,network,storage,raspberry-pi"><meta name=description content="I recently had to mount a samba share on Ubuntu 20.04 server on a Raspberry Pi 4, and found that piecing things together from examples was a bit of a pain
Installing the required packages Installing the required packages is easy, as they are available in the default installed repositories in Ubuntu and most other Linux distributions
sudo apt install smbclient cifs-utils Editing fstab To automatically mount the share on boot, the following line must be added to the end of /etc/fstab, with placeholders replaced:"><meta name=author content><link rel=canonical href=https://rosenbjerg.dk/posts/mounting-samba-drive-on-ubuntu-2004/><link crossorigin=anonymous href=/assets/css/stylesheet.min.c88963fe2d79462000fd0fb1b3737783c32855d340583e4523343f8735c787f0.css integrity="sha256-yIlj/i15RiAA/Q+xs3N3g8MoVdNAWD5FIzQ/hzXHh/A=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.min.b95bacdc39e37a332a9f883b1e78be4abc1fdca2bc1f2641f55e3cd3dabd4d61.js integrity="sha256-uVus3DnjejMqn4g7Hni+Srwf3KK8HyZB9V4809q9TWE=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://rosenbjerg.dk/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://rosenbjerg.dk/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://rosenbjerg.dk/favicon-32x32.png><link rel=apple-touch-icon href=https://rosenbjerg.dk/apple-touch-icon.png><link rel=mask-icon href=https://rosenbjerg.dk/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.113.0"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="Mounting samba share on Ubuntu 20.04"><meta property="og:description" content="I recently had to mount a samba share on Ubuntu 20.04 server on a Raspberry Pi 4, and found that piecing things together from examples was a bit of a pain
Installing the required packages Installing the required packages is easy, as they are available in the default installed repositories in Ubuntu and most other Linux distributions
sudo apt install smbclient cifs-utils Editing fstab To automatically mount the share on boot, the following line must be added to the end of /etc/fstab, with placeholders replaced:"><meta property="og:type" content="article"><meta property="og:url" content="https://rosenbjerg.dk/posts/mounting-samba-drive-on-ubuntu-2004/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-02-16T20:31:05+01:00"><meta property="article:modified_time" content="2022-02-16T20:31:05+01:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Mounting samba share on Ubuntu 20.04"><meta name=twitter:description content="I recently had to mount a samba share on Ubuntu 20.04 server on a Raspberry Pi 4, and found that piecing things together from examples was a bit of a pain
Installing the required packages Installing the required packages is easy, as they are available in the default installed repositories in Ubuntu and most other Linux distributions
sudo apt install smbclient cifs-utils Editing fstab To automatically mount the share on boot, the following line must be added to the end of /etc/fstab, with placeholders replaced:"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://rosenbjerg.dk/posts/"},{"@type":"ListItem","position":2,"name":"Mounting samba share on Ubuntu 20.04","item":"https://rosenbjerg.dk/posts/mounting-samba-drive-on-ubuntu-2004/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Mounting samba share on Ubuntu 20.04","name":"Mounting samba share on Ubuntu 20.04","description":"I recently had to mount a samba share on Ubuntu 20.04 server on a Raspberry Pi 4, and found that piecing things together from examples was a bit of a pain\nInstalling the required packages Installing the required packages is easy, as they are available in the default installed repositories in Ubuntu and most other Linux distributions\nsudo apt install smbclient cifs-utils Editing fstab To automatically mount the share on boot, the following line must be added to the end of /etc/fstab, with placeholders replaced:","keywords":["linux","nas","samba","network","storage","raspberry-pi"],"articleBody":"I recently had to mount a samba share on Ubuntu 20.04 server on a Raspberry Pi 4, and found that piecing things together from examples was a bit of a pain\nInstalling the required packages Installing the required packages is easy, as they are available in the default installed repositories in Ubuntu and most other Linux distributions\nsudo apt install smbclient cifs-utils Editing fstab To automatically mount the share on boot, the following line must be added to the end of /etc/fstab, with placeholders replaced:\n/// /mnt/ cifs vers=3.0,credentials=/home//.smb,uid=,gid=,x-systemd.automount,noperm,noatime With example values:\n//192.168.0.42/storage /mnt/mystorage cifs vers=3.0,credentials=/home/myuser/.smb,uid=1000,gid=1000,x-systemd.automount,noperm,noatime Flags used: vers=3.0 specifies the version of the samba (and SMB) protocol to use uid and gid specify the user and group to use when mounting the share noperm instructs the samba client to skip permission checks on client-side, as that is expected to be done by the server noatime instructs the samba client to not update the access time of accessed files, to avoid needless writes x-systemd.automount tells systemd to mount the share on first use instead of straight away on boot, so network can be established properly first Samba credentials Instead of putting the credentials in the fstab file, which every user can read, you can put them in a file that only your user can read. For example, this file could be placed in /home//.smb with the following content:\nuser= password= domain=WORKGROUP Mounting the share To mount the share without rebooting, you can run the following command:\nsudo mount -a You can then try listing the contents of the share with ls -l /mnt/\n","wordCount":"263","inLanguage":"en","datePublished":"2022-02-16T20:31:05+01:00","dateModified":"2022-02-16T20:31:05+01:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://rosenbjerg.dk/posts/mounting-samba-drive-on-ubuntu-2004/"},"publisher":{"@type":"Organization","name":"Rosenbjerg blog","logo":{"@type":"ImageObject","url":"https://rosenbjerg.dk/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://rosenbjerg.dk/ accesskey=h title="Rosenbjerg blog (Alt + H)">Rosenbjerg blog</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>Mounting samba share on Ubuntu 20.04</h1><div class=post-meta><span title='2022-02-16 20:31:05 +0100 +0100'>February 16, 2022</span></div></header><div class=post-content><p>I recently had to mount a samba share on <a href=https://ubuntu.com/download/raspberry-pi target=_blank>Ubuntu 20.04</a>
server on a Raspberry Pi 4, and found that piecing things together from examples was a bit of a pain</p><h2 id=installing-the-required-packages>Installing the required packages<a hidden class=anchor aria-hidden=true href=#installing-the-required-packages>#</a></h2><p>Installing the required packages is easy, as they are available in the default installed repositories in Ubuntu and most other Linux distributions</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>sudo apt install smbclient cifs-utils
</span></span></code></pre></div><h2 id=editing-fstab>Editing fstab<a hidden class=anchor aria-hidden=true href=#editing-fstab>#</a></h2><p>To automatically mount the share on boot, the following line must be added to the end of <code>/etc/fstab</code>, with placeholders replaced:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>//&lt;samba_server_ip&gt;/&lt;share_name&gt; /mnt/&lt;share_name&gt; cifs vers=3.0,credentials=/home/&lt;user&gt;/.smb,uid=&lt;user_id&gt;,gid=&lt;group_id&gt;,x-systemd.automount,noperm,noatime
</span></span></code></pre></div><p>With example values:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>//192.168.0.42/storage /mnt/mystorage cifs vers=3.0,credentials=/home/myuser/.smb,uid=1000,gid=1000,x-systemd.automount,noperm,noatime
</span></span></code></pre></div><h3 id=flags-used>Flags used:<a hidden class=anchor aria-hidden=true href=#flags-used>#</a></h3><ul><li><code>vers=3.0</code> specifies the version of the samba (and <code>SMB</code>) protocol to use</li><li><code>uid</code> and <code>gid</code> specify the user and group to use when mounting the share</li><li><code>noperm</code> instructs the samba client to skip permission checks on client-side, as that is expected to be done by the server</li><li><code>noatime</code> instructs the samba client to not update the access time of accessed files, to avoid needless writes</li><li><code>x-systemd.automount</code> tells systemd to mount the share on first use instead of straight away on boot, so network can be established properly first</li></ul><h2 id=samba-credentials>Samba credentials<a hidden class=anchor aria-hidden=true href=#samba-credentials>#</a></h2><p>Instead of putting the credentials in the fstab file, which every user can read, you can put them in a file that only your user can read.
For example, this file could be placed in <code>/home/&lt;user>/.smb</code> with the following content:</p><pre tabindex=0><code>user=&lt;samba_username&gt;
password=&lt;samba_password&gt;
domain=WORKGROUP
</code></pre><h2 id=mounting-the-share>Mounting the share<a hidden class=anchor aria-hidden=true href=#mounting-the-share>#</a></h2><p>To mount the share without rebooting, you can run the following command:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo mount -a
</span></span></code></pre></div><p>You can then try listing the contents of the share with <code>ls -l /mnt/&lt;share_name></code></p></div><footer class=post-footer><ul class=post-tags><li><a href=https://rosenbjerg.dk/tags/linux/>linux</a></li><li><a href=https://rosenbjerg.dk/tags/nas/>nas</a></li><li><a href=https://rosenbjerg.dk/tags/samba/>samba</a></li><li><a href=https://rosenbjerg.dk/tags/network/>network</a></li><li><a href=https://rosenbjerg.dk/tags/storage/>storage</a></li><li><a href=https://rosenbjerg.dk/tags/raspberry-pi/>raspberry-pi</a></li></ul></footer><script src=https://utteranc.es/client.js repo=rosenbjerg/rosenbjerg.github.io issue-term=pathname label=comment theme=preferred-color-scheme crossorigin=anonymous async></script></article></main><footer class=footer><span>&copy; 2023 <a href=https://rosenbjerg.dk/>Rosenbjerg blog</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>